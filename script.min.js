const canvas=document.getElementById("myCanvas"),ctx=canvas.getContext("2d");canvas.width=1008,canvas.height=630;const chooseImage=document.querySelector(".choose__image"),save=document.getElementById("save-button"),clear=document.getElementById("clear-button"),input=document.querySelector("input#tx");let tx,setImage="images/ma.jpg";chooseImage.addEventListener("click",e=>{e.stopPropagation(),setImage=e.target.getAttribute("src"),draw()}),input.addEventListener("input",e=>{e.preventDefault(),tx=e.target.value,draw()}),clear.addEventListener("click",e=>{e.preventDefault(),tx="",input.value="",draw()});let ts=new Date,date=ts.toLocaleDateString().replaceAll(".",""),time=ts.toLocaleTimeString().replaceAll(":",""),stamp=`${date}${time}`;save.addEventListener("click",e=>{if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(canvas.msToBlob(),`tvp-${stamp}.jpg`);else{const a=document.createElement("a");document.body.appendChild(a),a.href=canvas.toDataURL("image/jpeg"),a.download=`tvp-${stamp}.jpg`,a.click(),document.body.removeChild(a)}});const draw=()=>{if(canvas.getContext){const img=new Image;img.onload=function(){ctx.drawImage(img,0,0,canvas.width,canvas.height),tx&&text(tx)},img.src=setImage}else console.log("ERROR")},text=tx=>{ctx.fillStyle="#fff",ctx.font="3rem Arial",ctx.fillText(tx.toUpperCase(),canvas.width/5.2,canvas.height/1.22,canvas.width/1.4)};draw();